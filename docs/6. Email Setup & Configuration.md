# Email Setup & Configuration

## Overview
This document outlines the email infrastructure for CROWDIA, including domain configuration, Google Workspace setup, and email alias configuration.

## Domain Configuration

### Primary Domain
- **Domain:** crowdia.app
- **Registrar:** Namecheap
- **Email Provider:** Google Workspace
- **Status:** Verified & Active

### DNS Configuration

#### MX Records (Mail Exchange)
The following MX records are configured in Namecheap DNS for crowdia.app:

| Priority | Hostname | Value |
|----------|----------|-------|
| 1 | @ | ASPMX.L.GOOGLE.COM |
| 5 | @ | ALT1.ASPMX.L.GOOGLE.COM |
| 5 | @ | ALT2.ASPMX.L.GOOGLE.COM |
| 10 | @ | ALT3.ASPMX.L.GOOGLE.COM |
| 10 | @ | ALT4.ASPMX.L.GOOGLE.COM |

**Note:** The `@` symbol represents the root domain (crowdia.app)

#### Domain Verification
- **Method:** TXT record
- **Status:** Verified in Google Workspace Admin Console
- **Location:** Google Admin Console → Domains → Manage domains

## Google Workspace Setup

### Organization
- **Primary Domain:** metatech.dev
- **Secondary Domains:** 
  - bedda.tech
  - crowdia.app
  - nomadiqe.com
  - lucacorrao.com

### Email Addresses

#### Primary User: Mattia Orlando
- **Primary Email:** mattia@metatech.dev
- **Alternate Emails:**
  - mattia@bedda.tech
  - info@crowdia.app
  - mattia@crowdia.app

### Email Aliases Configuration

To add email aliases for a user:

1. Go to **Google Admin Console** → **Users**
2. Select the user (e.g., Mattia Orlando)
3. Click **User information**
4. Under **Alternate email addresses (email alias)**, click **ADD ALTERNATE EMAILS**
5. Enter the alias email (e.g., info@crowdia.app)
6. Click **SAVE**

## Email Routing

### Incoming Mail
- Emails sent to `info@crowdia.app` → Delivered to `mattia@metatech.dev` inbox
- Emails sent to `mattia@crowdia.app` → Delivered to `mattia@metatech.dev` inbox

### Outgoing Mail
Users can send emails FROM any of their alternate email addresses:
1. Open Gmail
2. Click **Compose**
3. Click the **From** dropdown
4. Select the desired email address (e.g., info@crowdia.app)

## Troubleshooting

### Common Issues

#### "Relay access denied" Error (554 5.7.1)
**Symptom:** Emails bounce back with "relay access denied" message

**Cause:** Incorrect MX records pointing to wrong mail server

**Solution:**
1. Verify MX records in Namecheap point to Google's mail servers (ASPMX.L.GOOGLE.COM, etc.)
2. Ensure there are no typos (e.g., SMTPGOOGLE.COM is incorrect)
3. Wait 5-10 minutes for DNS propagation after making changes

#### "User not found" Error
**Symptom:** Emails bounce back with "user not found" or similar message

**Cause:** Email alias not created in Google Workspace

**Solution:**
1. Verify the domain is added and verified in Google Admin Console
2. Check that the email alias exists under the user's profile
3. Ensure Gmail is activated for the domain

#### DNS Propagation Delays
**Symptom:** Changes to MX records don't take effect immediately

**Solution:**
- DNS changes can take up to 48 hours to fully propagate globally
- Most changes propagate within 5-10 minutes
- Use online DNS lookup tools to verify MX records are updated

### Verification Steps

To verify email is working correctly:

1. **Check MX Records:**
   ```bash
   nslookup -type=MX crowdia.app
   ```
   Should return Google's mail servers

2. **Send Test Email:**
   - Send an email to the alias (e.g., info@crowdia.app)
   - Check that it arrives in the primary inbox
   - Verify no bounce-back error

3. **Check Domain Status:**
   - Google Admin Console → Domains → Manage domains
   - Verify crowdia.app shows "Verified" and "Gmail activated"

## Security Best Practices

### SPF Record
Add an SPF record to prevent email spoofing:
```
Type: TXT
Host: @
Value: v=spf1 include:_spf.google.com ~all
```

### DKIM
Enable DKIM signing in Google Workspace:
1. Google Admin Console → Apps → Google Workspace → Gmail
2. Click **Authenticate email**
3. Select domain → **Generate new record**
4. Add the provided TXT record to Namecheap DNS

### DMARC
Add a DMARC policy:
```
Type: TXT
Host: _dmarc
Value: v=DMARC1; p=quarantine; rua=mailto:admin@crowdia.app
```

## Contact Information

### Primary Email Contacts
- **General Inquiries:** info@crowdia.app
- **Team Lead:** mattia@crowdia.app
- **Tech Support:** (to be configured)

## Change Log

| Date | Change | Modified By |
|------|--------|-------------|
| 2025-11-14 | Initial email setup documentation | Claude |
| 2025-11-14 | Fixed MX records (SMTPGOOGLE.COM → ASPMX.L.GOOGLE.COM) | Claude |
| 2025-11-14 | Added alternate emails for Mattia Orlando | Claude |

## References

- [Google Workspace MX Record Values](https://support.google.com/a/answer/140034)
- [Namecheap DNS Management](https://www.namecheap.com/support/knowledgebase/article.aspx/767/10/how-to-change-dns-for-a-domain/)
- [Google Workspace Email Alias Setup](https://support.google.com/a/answer/33327)
